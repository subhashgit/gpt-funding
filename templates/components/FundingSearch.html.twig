<!-- Table Section -->
<div{{ attributes }} class="">

    {% set fundings = this.fundings %}
    <div class="container mx-auto py-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <!-- Filters -->
            <div class="bg-white p-4 shadow-md col-span-1">
                <h2 class="text-lg font-semibold mb-4">Filters</h2>

                <div class="space-y-2">
                    <div class="hs-accordion-group" data-hs-accordion-always-open>

{#                        <div class="hs-accordion active" id="hs-basic-always-open-heading-1">#}
{#                            <button class="hs-accordion-toggle hs-accordion-active:text-blue-600 py-3 inline-flex items-center gap-x-3 w-full font-semibold text-left text-gray-800 transition hover:text-gray-500 dark:hs-accordion-active:text-blue-500 dark:text-gray-200 dark:hover:text-gray-400"#}
{#                                    aria-controls="hs-basic-always-open-collapse-1">#}
{#                                <svg class="hs-accordion-active:hidden hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 block w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"#}
{#                                     width="16" height="16" viewBox="0 0 16 16" fill="none"#}
{#                                     xmlns="http://www.w3.org/2000/svg">#}
{#                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"#}
{#                                          stroke-linecap="round"/>#}
{#                                    <path d="M8.12421 13.36V2.35999" stroke="currentColor" stroke-width="2"#}
{#                                          stroke-linecap="round"/>#}
{#                                </svg>#}
{#                                <svg class="hs-accordion-active:block hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 hidden w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"#}
{#                                     width="16" height="16" viewBox="0 0 16 16" fill="none"#}
{#                                     xmlns="http://www.w3.org/2000/svg">#}
{#                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"#}
{#                                          stroke-linecap="round"/>#}
{#                                </svg>#}
{#                                Recommended for you#}
{#                            </button>#}
{#                            <div id="hs-basic-always-open-collapse-1"#}
{#                                 class="hs-accordion-content w-full overflow-hidden transition-[height] duration-300"#}
{#                                 aria-labelledby="hs-basic-always-open-heading-1">#}
{#                                <label for="hs-as-filters-dropdown-ai"#}
{#                                       class="flex py-2.5 px-3">#}
{#                                    <input type="checkbox"#}
{#                                           {% if app.user.companies.count == 0  %}disabled{% endif %}#}
{#                                           data-action="live#action"#}
{#                                           data-action-name="filter(filter=ai, value=true)"#}
{#                                           class="shrink-0 mt-0.5 border-gray-200 rounded text-blue-600 pointer-events-none focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"#}
{#                                           id="hs-as-filters-dropdown-ai">#}
{#                                    <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">#}
{#                                        Recommended Tenders#}

{#                                        {% if not app.user.subscriptionActive %}#}
{#                                            <i>(Please subscribe to get access to this feature#}
{#                                                <a class="text-blue-600 decoration-2 hover:underline"#}
{#                                                   href="{{ path('app_payment_subscribe') }}">here</a>)#}
{#                                            </i>#}
{#                                        {% else#}
{#                                            {% if app.user.companies.count == 0 %}#}
{#                                            <i>(Please add your company information to get recommendations#}
{#                                                <a class="text-blue-600 decoration-2 hover:underline"#}
{#                                                   href="{{ path('app_company') }}">here</a>)#}
{#                                            </i>#}
{#                                        {% endif %}#}
{#                                    </span>#}
{#                                </label>#}
{#                            </div>#}
{#                        </div>#}

                        <div class="hs-accordion active" id="hs-basic-always-open-heading-one">
                            <button class="hs-accordion-toggle hs-accordion-active:text-blue-600 py-3 inline-flex items-center gap-x-3 w-full font-semibold text-left text-gray-800 transition hover:text-gray-500 dark:hs-accordion-active:text-blue-500 dark:text-gray-200 dark:hover:text-gray-400"
                                    aria-controls="hs-basic-always-open-collapse-one">
                                <svg class="hs-accordion-active:hidden hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 block w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                    <path d="M8.12421 13.36V2.35999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                <svg class="hs-accordion-active:block hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 hidden w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                Region
                            </button>
                            <div id="hs-basic-always-open-collapse-one"
                                 class="hs-accordion-content w-full overflow-hidden transition-[height] duration-300"
                                 aria-labelledby="hs-basic-always-open-heading-one">
                                {% for filter in this.filters.region %}
                                    <label for="hs-as-filters-dropdown-{{ filter|replace({' ': '_'}) }}"
                                           class="flex py-2.5 px-3">
                                        <input type="checkbox"
                                               data-action="live#action"
                                               data-live-action-param="filter"
                                               data-live-filter-param="region"
                                               data-live-value-param="{{ filter }}"
                                               class="shrink-0 mt-0.5 border-gray-200 rounded text-blue-600 pointer-events-none focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"
                                               id="hs-as-filters-dropdown-{{ filter|replace({' ': '_'}) }}">
                                        <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">{{ filter }}</span>
                                    </label>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="hs-accordion" id="hs-basic-always-open-heading-two">
                            <button class="hs-accordion-toggle hs-accordion-active:text-blue-600 py-3 inline-flex items-center gap-x-3 w-full font-semibold text-left text-gray-800 transition hover:text-gray-500 dark:hs-accordion-active:text-blue-500 dark:text-gray-200 dark:hover:text-gray-400"
                                    aria-controls="hs-basic-always-open-collapse-two">
                                <svg class="hs-accordion-active:hidden hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 block w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                    <path d="M8.12421 13.36V2.35999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                <svg class="hs-accordion-active:block hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 hidden w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                Sector
                            </button>
                            <div id="hs-basic-always-open-collapse-two"
                                 class="hs-accordion-content hidden w-full overflow-hidden transition-[height] duration-300"
                                 aria-labelledby="hs-basic-always-open-heading-two">
                                {% for key, filter in this.filters.sector %}
                                    <label for="hs-as-filters-dropdown-{{ filter|replace({' ': '_', ',': ''}) }}"
                                           class="flex py-2.5 px-3">
                                        <input type="checkbox"
                                               data-action="live#action"

                                               data-live-action-param="filter"
                                               data-live-filter-param="sector"
                                               data-live-value-param="{{ key }}"

                                               class="shrink-0 mt-0.5 border-gray-200 rounded text-blue-600 pointer-events-none focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"
                                               id="hs-as-filters-dropdown-{{ filter|replace({' ': '_', ',': ''}) }}">
                                        <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">{{ filter }}</span>
                                    </label>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="hs-accordion" id="hs-basic-always-open-heading-three">
                            <button class="hs-accordion-toggle hs-accordion-active:text-blue-600 py-3 inline-flex items-center gap-x-3 w-full font-semibold text-left text-gray-800 transition hover:text-gray-500 dark:hs-accordion-active:text-blue-500 dark:text-gray-200 dark:hover:text-gray-400"
                                    aria-controls="hs-basic-always-open-collapse-three">
                                <svg class="hs-accordion-active:hidden hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 block w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                    <path d="M8.12421 13.36V2.35999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                <svg class="hs-accordion-active:block hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 hidden w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                Date Range
                            </button>
                            <div id="hs-basic-always-open-collapse-three"
                                 class="hs-accordion-content hidden w-full overflow-hidden transition-[height] duration-300"
                                 aria-labelledby="hs-basic-always-open-heading-two">
                                <div class="flex flex-wrap">

                                    <div class="w-full px-3 mt-8">
                                        <h2 class="block text-gray-700 text-lg font-bold mb-2">Publication Date</h2>
                                        <p class="text-gray-600 text-md mb-4">Please select a date range</p>

                                        <div class="mb-4">
                                            <label class="block text-gray-700 text-md font-bold mb-2"
                                                   for="start-date-1">From</label>
                                            <input data-model="debounce(1000)|publication_start_date"
                                                   class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                   id="start-date-1" type="date">
                                        </div>

                                        <div class="mb-4">
                                            <label class="block text-gray-700 text-md font-bold mb-2" for="end-date-1">To</label>
                                            <input data-model="debounce(1000)|publication_end_date"
                                                   class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                   id="end-date-1" type="date">
                                        </div>
                                    </div>

                                    <div class="w-full px-3 mt-8">
                                        <h2 class="block text-gray-700 text-lg font-bold mb-2">Closing Date</h2>
                                        <p class="text-gray-600 text-md mb-4">Please select a second date range</p>

                                        <div class="mb-4">
                                            <label class="block text-gray-700 text-md font-bold mb-2"
                                                   for="start-date-2">From</label>
                                            <input data-model="debounce(1000)|closing_start_date"
                                                   class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                   id="start-date-2" type="date">
                                        </div>

                                        <div class="mb-4">
                                            <label class="block text-gray-700 text-md font-bold mb-2" for="end-date-2">To</label>
                                            <input data-model="debounce(1000)|closing_end_date"
                                                   class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                   id="end-date-2" type="date">
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <div class="hs-accordion" id="hs-basic-always-open-heading-four">
                            <button class="hs-accordion-toggle hs-accordion-active:text-blue-600 py-3 inline-flex items-center gap-x-3 w-full font-semibold text-left text-gray-800 transition hover:text-gray-500 dark:hs-accordion-active:text-blue-500 dark:text-gray-200 dark:hover:text-gray-400"
                                    aria-controls="hs-basic-always-open-collapse-four">
                                <svg class="hs-accordion-active:hidden hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 block w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                    <path d="M8.12421 13.36V2.35999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                <svg class="hs-accordion-active:block hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 hidden w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                Favourites
                            </button>
                            <div id="hs-basic-always-open-collapse-four"
                                 class="hs-accordion-content hidden w-full overflow-hidden transition-[height] duration-300"
                                 aria-labelledby="hs-basic-always-open-heading-two">
                                <div class="flex flex-wrap">

                                    <label for="hs-as-filters-dropdown-watching"
                                           class="flex py-2.5 px-3">
                                        <input type="checkbox"
                                               data-action="live#action"
                                               data-live-action-param="filter"
                                               data-live-filter-param="watching"
                                               data-live-value-param=true
                                               class="shrink-0 mt-0.5 border-gray-200 rounded text-blue-600 pointer-events-none focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"
                                               id="hs-as-filters-dropdown-watching">
                                        <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">Favourites only</span>
                                    </label>

                                </div>

                            </div>
                        </div>
                        <div class="hs-accordion" id="hs-basic-always-open-heading-five">
                            <button class="hs-accordion-toggle hs-accordion-active:text-blue-600 py-3 inline-flex items-center gap-x-3 w-full font-semibold text-left text-gray-800 transition hover:text-gray-500 dark:hs-accordion-active:text-blue-500 dark:text-gray-200 dark:hover:text-gray-400"
                                    aria-controls="hs-basic-always-open-collapse-five">
                                <svg class="hs-accordion-active:hidden hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 block w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                    <path d="M8.12421 13.36V2.35999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                <svg class="hs-accordion-active:block hs-accordion-active:text-blue-600 hs-accordion-active:group-hover:text-blue-600 hidden w-3 h-3 text-gray-600 group-hover:text-gray-500 dark:text-gray-400"
                                     width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.62421 7.86L13.6242 7.85999" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round"/>
                                </svg>
                                Type
                            </button>
                            <div id="hs-basic-always-open-collapse-five"
                                 class="hs-accordion-content hidden w-full overflow-hidden transition-[height] duration-300"
                                 aria-labelledby="hs-basic-always-open-heading-five">
                                {% for tag in this.tags %}
                                    <label for="hs-as-filters-dropdown-{{ tag }}"
                                           class="flex py-2.5 px-3">
                                        <input type="checkbox"
                                               data-action="live#action"

                                               data-live-action-param="filter"
                                               data-live-filter-param="tags"
                                               data-live-value-param="{{ tag }}"

                                               class="shrink-0 mt-0.5 border-gray-200 rounded text-blue-600 pointer-events-none focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"
                                               id="hs-as-filters-dropdown-{{ tag }}">
                                        <span class="ml-3 text-sm text-gray-800 dark:text-gray-200">{{ tag|title }}</span>
                                    </label>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <!-- Add more accordion items as needed -->
                </div>
            </div>

            <!-- Items -->
            <div class="bg-white p-4 shadow-md col-span-3">
                {#                <h2 class="text-lg font-semibold mb-4">Items</h2> #}
                <!-- Search -->
                <div class="mb-4">
                    <input type="text" placeholder="Search items"
                           data-model="query"
                           data-action="live#action"
                           data-live-action-param="debounce(500)|search"
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    {#                    <button #}
                    {#                            class="px-4 py-2 bg-blue-500 text-white rounded-md ml-2 hover:bg-blue-600 focus:outline-none focus:bg-blue-600"> #}
                    {#                        Search #}
                    {#                    </button> #}
                </div>

                <div class="mb-4">
                    {{ include('utils/sort.html.twig') }}
                </div>

                <div class="flex items-center justify-between mb-4">
                    <p class="text-gray-600">Total Items:</p>
                    <p id="itemsCount" class="text-gray-900 font-semibold">{{ fundings.count }}</p>
                </div>

                <!-- Item 1 -->

                {% for item in fundings.items %}
                    <div class="relative border-gray-200 p-2" data-loading="addClass(opacity-30)">
                        <div class="absolute top-2 right-2 w-6 h-6">

                            <button
                                    type="button"
                                    class="btn btn-secondary"
                                    data-action="live#action"
                                    data-live-action-param="like"
                                    data-live-filter-param="entity"
                                    data-live-entity-param={{ item.id }}
                            >
                                {% if item.id in this.likedIds %}
                                    <i class="fa-solid fa-star"></i>
                                {% else %}
                                    <i class="fa-regular fa-star"></i>
                                {% endif %}
                            </button>

                        </div>

                        <a href="{{ path('app_funding_view', { slug: item.slug }) }}"
                           class="block p-2 border-b border-gray-200">
                            <div>
                                <h3 class="text-xl font-semibold">
                                    {{ item.title }}
                                </h3>
                                <p class="text-sm text-gray-400">{{ item.organisationName }}</p>
                                <p class="text-gray-600">{{ item.description|striptags|u.truncate(200, '...')|raw }}</p>
                                <ul class="list-disc pl-4">
                                    <li><b>Procurement stage:</b> Opportunity</li>
                                    <li><b>Notice status:</b> Open</li>
                                    <li>
                                        <b>Closing:</b> {{ item.closingDate|format_datetime }}
                                    </li>
                                    <li><b>Contract location:</b> {{ item.fundingRegions|join(', ') }}</li>
                                    <li><b>Contract value:</b> {{ item.valueLow|format_currency('GBP', {
                                            fraction_digit: 0,
                                        }) }}
                                        {% if item.valueHigh %}
                                            - {{ item.valueHigh|format_currency('GBP', {
                                            fraction_digit: 0
                                        }) }}
                                        {% endif %}</li>
                                    <li><b>Publication date:</b> {{ item.publishedDate|format_date }}</li>
                                </ul>
                            </div>
                        </a>
                    </div>
                {% endfor %}


                {% if app.user.subscriptionActive %}
                    <nav class="flex items-center justify-between mt-4">
                        <button class="py-2 px-4 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300"
                                type="button"
                                {% if not fundings.hasPrevPage %}disabled{% endif %}
                                data-controller="scroll-top"
                                data-action="click->scroll-top#scrollToTop live#action"

                                data-live-action-param="prevPage"

                        >Previous
                        </button>

                        <button type="button"
                                {% if not fundings.hasNextPage %}disabled{% endif %}
                                data-controller="scroll-top"
                                data-action="click->scroll-top#scrollToTop live#action"
                                data-live-action-param="nextPage"
                                class="py-2 px-4 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">Next
                        </button>
                    </nav>
                {% endif %}

                <!-- Add more items as needed -->

            </div>
        </div>
    </div>

</div>
<!-- End Table Section -->
